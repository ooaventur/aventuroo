<script>
renderHeader(''); renderFooter();

function qs(k){const u=new URL(location.href);return u.searchParams.get(k)||'';}

function card(p){
  return `
  <div class="col-sm-6 col-lg-4">
    <article class="card border-0 shadow-soft h-100">
      <a href="article.html?slug=${p.slug}">
        <img src="${p.cover}" class="card-img-top" alt="${p.title}">
      </a>
      <div class="card-body d-flex flex-column">
        <span class="badge badge-cat">${p.category}</span>
        <h5 class="card-title mt-2">
          <a class="link-dark" href="article.html?slug=${p.slug}">${p.title}</a>
        </h5>
        <p class="card-text muted line-clamp-3">${p.excerpt}</p>
        <div class="mt-auto d-flex justify-content-between small muted">
          <span>${p.date||''}</span>
          <a class="link-primary" href="article.html?slug=${p.slug}">Read â†’</a>
        </div>
      </div>
    </article>
  </div>`;
}

async function load(){
  const q = (qs('q')||'').toLowerCase().trim();
  document.getElementById('qq').textContent = q || '(empty)';

  const r = await fetch('data/posts.json');
  const posts = r.ok ? await r.json() : [];

  const results = q
    ? posts.filter(p => [p.title,p.excerpt,p.category].join(' ').toLowerCase().includes(q))
    : [];

  document.getElementById('results').innerHTML =
    results.length
      ? results.map(card).join('')
      : `<div class="col-12 text-center text-muted py-5">No results found.</div>`;
}
load();
</script>